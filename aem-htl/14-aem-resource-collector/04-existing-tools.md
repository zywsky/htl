# 现有工具分析

## 目录
1. [AEM 官方工具](#aem-官方工具)
2. [第三方工具](#第三方工具)
3. [自定义工具](#自定义工具)
4. [工具对比](#工具对比)
5. [推荐方案](#推荐方案)

---

## AEM 官方工具

### 1. CRX/DE Lite

**位置**: `http://localhost:4502/crx/de/index.jsp`

**功能**:
- ✅ 浏览 JCR 节点结构
- ✅ 查看节点属性
- ✅ 下载文件内容
- ✅ 编辑节点属性

**局限性**:
- ❌ 需要手动操作
- ❌ 无法批量收集
- ❌ 无法分析依赖关系
- ❌ 无法生成结构化输出

**适用场景**: 手动查看单个组件信息

### 2. AEM ClientLibs Dump Tool

**位置**: `http://localhost:4502/libs/granite/ui/content/dumplibs.html`

**功能**:
- ✅ 列出所有 ClientLibs
- ✅ 显示 categories
- ✅ 显示依赖关系
- ✅ 显示文件列表

**局限性**:
- ❌ 只针对 ClientLibs
- ❌ 无法收集组件其他信息
- ❌ 无法导出数据

**适用场景**: 查看 ClientLibs 信息

### 3. AEM Package Manager

**位置**: `http://localhost:4502/crx/packmgr/index.jsp`

**功能**:
- ✅ 打包组件文件
- ✅ 下载组件包
- ✅ 包含所有相关文件

**局限性**:
- ❌ 打包的是文件系统结构，不是组件信息
- ❌ 无法提取配置信息
- ❌ 无法分析依赖关系
- ❌ 需要解压后才能查看

**适用场景**: 备份组件文件

### 4. Sling Resource Resolver

**API**: `/system/console/resolver`

**功能**:
- ✅ 解析资源路径
- ✅ 查看资源类型
- ✅ 查看继承关系

**局限性**:
- ❌ 需要编程访问
- ❌ 只提供基础信息
- ❌ 无法批量处理

**适用场景**: 程序化资源解析

---

## 第三方工具

### 1. AEM Component Exporter

**GitHub**: 无官方工具

**功能**: 社区开发的组件导出工具

**特点**:
- ✅ 导出组件结构
- ✅ 包含配置文件
- ✅ 支持批量导出

**局限性**:
- ❌ 功能有限
- ❌ 维护不活跃
- ❌ 文档不完整

### 2. AEM Migration Tools

**GitHub**: 多个项目

**功能**: 用于 AEM 迁移的工具集

**特点**:
- ✅ 支持多种迁移场景
- ✅ 包含组件分析功能

**局限性**:
- ❌ 主要针对特定迁移场景
- ❌ 可能不适合 React 迁移

### 3. Sling Models Analyzer

**功能**: 分析 Sling Models 的工具

**特点**:
- ✅ 分析 Model 结构
- ✅ 提取属性定义
- ✅ 生成文档

**局限性**:
- ❌ 只针对 Sling Models
- ❌ 不包含组件其他信息

---

## 自定义工具

### 1. 组件依赖分析器（已有）

**位置**: `04-advanced/tools/component-dependency-analyzer.js`

**功能**:
- ✅ 分析组件依赖
- ✅ 提取 ClientLibs
- ✅ 提取 Sling Models
- ✅ 生成 React 迁移报告

**局限性**:
- ❌ 功能相对简单
- ❌ 无法收集所有文件内容
- ❌ 无法处理复杂依赖关系

**改进方向**:
- 增强文件收集能力
- 支持递归收集
- 支持更多输出格式

### 2. 资源收集器（新建）

**位置**: `14-aem-resource-collector/tools/component-resource-collector.js`

**功能**:
- ✅ 完整的组件信息收集
- ✅ 文件内容提取
- ✅ 配置解析
- ✅ 依赖分析
- ✅ React 迁移支持

**优势**:
- ✅ 功能全面
- ✅ 支持多种输出格式
- ✅ 可扩展性强

---

## 工具对比

### 功能对比表

| 工具 | 文件收集 | 配置解析 | 依赖分析 | React 支持 | 批量处理 | 自动化 |
|------|---------|---------|---------|-----------|---------|--------|
| CRX/DE Lite | ⚠️ 手动 | ⚠️ 手动 | ❌ | ❌ | ❌ | ❌ |
| ClientLibs Dump | ❌ | ❌ | ⚠️ 部分 | ❌ | ❌ | ❌ |
| Package Manager | ✅ | ❌ | ❌ | ❌ | ✅ | ⚠️ |
| 组件依赖分析器 | ⚠️ 部分 | ⚠️ 部分 | ✅ | ✅ | ⚠️ | ✅ |
| 资源收集器 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

### 使用场景对比

#### 场景 1: 快速查看组件信息

**推荐**: CRX/DE Lite

**原因**: 简单直接，无需编程

#### 场景 2: 查看 ClientLibs 信息

**推荐**: AEM ClientLibs Dump Tool

**原因**: 专门针对 ClientLibs，信息完整

#### 场景 3: 备份组件文件

**推荐**: AEM Package Manager

**原因**: 可以打包所有文件

#### 场景 4: 组件迁移分析

**推荐**: 资源收集器（新建）

**原因**: 功能全面，支持迁移场景

#### 场景 5: 批量组件分析

**推荐**: 资源收集器（新建）

**原因**: 支持批量处理和自动化

---

## 推荐方案

### 方案 1: 使用现有工具组合

**工具组合**:
1. CRX/DE Lite - 查看组件结构
2. ClientLibs Dump - 查看 ClientLibs
3. Package Manager - 下载组件文件
4. 手动分析 - 整理信息

**优点**:
- ✅ 无需开发
- ✅ 使用官方工具

**缺点**:
- ❌ 效率低
- ❌ 容易遗漏
- ❌ 无法自动化

**适用场景**: 少量组件迁移

### 方案 2: 使用组件依赖分析器

**工具**: `component-dependency-analyzer.js`

**优点**:
- ✅ 已有实现
- ✅ 支持依赖分析
- ✅ 支持 React 迁移

**缺点**:
- ❌ 功能有限
- ❌ 无法收集完整文件内容

**适用场景**: 简单组件迁移

### 方案 3: 使用资源收集器（推荐）

**工具**: `component-resource-collector.js`

**优点**:
- ✅ 功能全面
- ✅ 自动化程度高
- ✅ 支持多种输出格式
- ✅ 可扩展性强

**缺点**:
- ❌ 需要开发维护
- ❌ 可能需要根据项目定制

**适用场景**: 大规模组件迁移、React 迁移

### 方案 4: 混合方案

**工具组合**:
1. 资源收集器 - 主要工具
2. CRX/DE Lite - 手动验证
3. ClientLibs Dump - 验证 ClientLibs

**优点**:
- ✅ 自动化 + 手动验证
- ✅ 准确性高

**适用场景**: 生产环境迁移

---

## 工具选择建议

### 根据项目规模选择

#### 小型项目（< 10 个组件）

**推荐**: 方案 1（现有工具组合）

**原因**: 组件少，手动操作可行

#### 中型项目（10-50 个组件）

**推荐**: 方案 2（组件依赖分析器）或 方案 3（资源收集器）

**原因**: 需要一定程度的自动化

#### 大型项目（> 50 个组件）

**推荐**: 方案 3（资源收集器）

**原因**: 必须自动化，效率优先

### 根据迁移复杂度选择

#### 简单组件（无依赖、无配置）

**推荐**: 方案 1（现有工具组合）

**原因**: 简单组件手动操作更快

#### 中等复杂度（有依赖、有配置）

**推荐**: 方案 2（组件依赖分析器）

**原因**: 需要依赖分析，但不需要完整文件内容

#### 复杂组件（多依赖、多配置、多文件）

**推荐**: 方案 3（资源收集器）

**原因**: 需要完整信息收集和分析

### 根据团队能力选择

#### 团队熟悉 AEM 和 Node.js

**推荐**: 方案 3（资源收集器）

**原因**: 可以定制和扩展

#### 团队不熟悉编程

**推荐**: 方案 1（现有工具组合）

**原因**: 使用官方工具，无需编程

---

## 总结

### 核心要点

1. **现有工具**: AEM 提供了基础工具，但功能有限
2. **第三方工具**: 有一些社区工具，但可能不适合特定场景
3. **自定义工具**: 需要根据项目需求开发
4. **推荐方案**: 根据项目规模和复杂度选择合适方案

### 最佳实践

1. **评估需求**: 先评估项目规模和复杂度
2. **选择工具**: 根据需求选择合适的工具或方案
3. **验证结果**: 使用多种工具交叉验证
4. **持续改进**: 根据使用情况改进工具

### 下一步

- 阅读 [实现指南](./05-implementation-guide.md) 了解如何实现资源收集器
- 阅读 [收集策略详解](./03-collection-strategies.md) 了解收集策略
- 使用 [资源收集器工具](../tools/component-resource-collector.js) 开始收集组件信息

